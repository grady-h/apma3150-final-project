---
title: "Final Project: CYP-GUIDES Trial"
author: "Thomas Chia, Eugene Choo, and Grady Hollar"
date: 'Due: Fri July 12 | 1:40pm'
output:
  html_document:
    toc: true
    toc_float: true
    df_print: paged
editor_options: 
  markdown:
    wrap: 72
---

**APMA 3150 \| Summer 2024 \| University of Virginia\
*"On our honor, we pledge that we have neither given nor received help
on this assignment." - Thomas Chia, \_\_, Grady Hollar.***

------------------------------------------------------------------------
### Global Package Imports

```{r}
library(tidyverse)
library(car)
```

### Data Initialization

```{r}
data <- read.csv("data/Dataset.csv")
medication_key <- read.csv("data/Medicationkey.csv")
```

```{r}
# Lets begin by taking a look into the datasets.
head(data)
print(colnames(data))

head(medication_key)
print(colnames(medication_key))
```

------------------------------------------------------------------------

### ANOVA: Determining if assignment, gender, or ethnicity impacts the length of stay (LOS).

```{r}
data$GENDER <- as.factor(data$GENDER)
data$`RACE.ETHNICITY` <- as.factor(data$`RACE.ETHNICITY`)
data$Assignment <- as.factor(data$Assignment)
data$EMR <- as.factor(data$EMR)
data$`Therapeutic.Guidances` <- as.factor(data$`Therapeutic.Guidances`)

anova_model <- aov(LOS ~ Assignment + GENDER + `RACE.ETHNICITY`, data = data)
summary(anova_model)
```
**Understanding the results:** The Assignment variable has a P-value of 0.825 which is significantly higher than our $\alpha$ of 0.05. Therefore it does not impact the length of stay. However, gender and ethnicity both have statistically significant P-values, indicating that these variables indeed do have an impact on the length of stay.

```{r}
# Boxplots
par(mfrow = c(1, 3))  # Set up the plotting area to have 1 row and 3 columns

# Boxplot for ASSIGNMENT
boxplot(LOS ~ Assignment, data = data, main = "LOS by ASSIGNMENT",
        xlab = "ASSIGNMENT", ylab = "Length of Stay (LOS)", col = "lightblue")

# Boxplot for GENDER
boxplot(LOS ~ GENDER, data = data, main = "LOS by GENDER",
        xlab = "GENDER", ylab = "Length of Stay (LOS)", col = "lightgreen")

# Boxplot for RACE.ETHNICITY
boxplot(LOS ~ RACE.ETHNICITY, data = data, main = "LOS by RACE.ETHNICITY",
        xlab = "RACE.ETHNICITY", ylab = "Length of Stay (LOS)", col = "lightcoral")
```

------------------------------------------------------------------------

### Multivariate Regression Analysis

------------------------------------------------------------------------

### Survival Analysis

------------------------------------------------------------------------

### Paired T-Test

------------------------------------------------------------------------

### Propensity Score Matching
